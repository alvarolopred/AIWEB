<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GalacticTravels - Asistente IA</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #0b0d17; color: #fff; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .chat-container { width: 400px; background-color: #15192b; padding: 20px; border-radius: 10px; box-shadow: 0 0 20px rgba(0,255,255,0.2); }
        h2 { text-align: center; color: #00d4ff; }
        #answer-box { margin-top: 20px; padding: 15px; background: #1e233b; border-radius: 5px; min-height: 50px; border-left: 4px solid #00d4ff; display: none; }
        input { width: 70%; padding: 10px; border-radius: 5px; border: none; }
        button { width: 25%; padding: 10px; background-color: #00d4ff; border: none; border-radius: 5px; color: #000; font-weight: bold; cursor: pointer; }
        button:hover { background-color: #00a3cc; }
        .loading { color: #888; font-style: italic; }
    </style>
</head>
<body>

<div class="chat-container">
    <h2> GalacticTravels IA</h2>
    <p>Pregunta sobre tus vacaciones espaciales:</p>
    
    <div style="display:flex; justify-content:space-between;">
        <input type="text" id="question" placeholder="Ej: 驴Es seguro viajar?">
        <button onclick="askAzure()">Enviar</button>
    </div>

    <div id="answer-box"></div>
</div>

<script>
    // CONFIGURACIN DE AZURE (RELLENA ESTOS DATOS)
    const resourceName = "nam12u"; // Solo el nombre, ej: "ia-espacio-test"
    const projectName = "name";
    const deploymentName = "production"; // Normalmente es "production"
    const apiKey = "2ALQSfysxfidBQSlpixCesUDSFvqUL2juViXMCVl6ZB0apItcyypJQQJ99CAACfhMk5XJ3w3AAAaACOGyqoU"; 

    async function askAzure() {
        const question = document.getElementById('question').value;
        const answerBox = document.getElementById('answer-box');
        
        if (!question) return;

        answerBox.style.display = 'block';
        answerBox.innerHTML = '<span class="loading">Consultando a la base estelar...</span>';

        // URL del Endpoint de Azure Language (Question Answering)
        const url = `https://${resourceName}.cognitiveservices.azure.com/language/:query-knowledgebases?projectName=${projectName}&api-version=2021-10-01&deploymentName=${deploymentName}`;

        const body = {
            question: question,
            confidenceScoreThreshold: 0.3 // Optimizaci贸n: umbral m铆nimo de confianza
        };

        try {
            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Ocp-Apim-Subscription-Key': apiKey,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(body)
            });

            const data = await response.json();

            if (data.answers && data.answers.length > 0) {
                const bestAnswer = data.answers[0];
                // Optimizaci贸n: Si la confianza es muy baja, dar respuesta gen茅rica
                if (bestAnswer.confidenceScore < 0.3) {
                    answerBox.innerText = "Lo siento, no tengo informaci贸n sobre eso en mis registros espaciales.";
                } else {
                    answerBox.innerText = bestAnswer.answer;
                }
            } else {
                answerBox.innerText = "No se encontr贸 respuesta.";
            }

        } catch (error) {
            console.error('Error:', error);
            answerBox.innerText = "Error de comunicaci贸n con Azure.";
        }
    }
</script>

</body>
</html>